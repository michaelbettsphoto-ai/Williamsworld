<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>William's World - Battle System Demo</title>
  <style>
    :root {
      --bg: #1a0e2e;
      --panel: rgba(30, 15, 40, 0.85);
      --text: #fff5e6;
      --gold: #ffd36e;
      --green: #7dffb4;
      --blue: #60a5fa;
      --red: #dc2626;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a0e2e 0%, #2d1b4e 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 3em;
      color: var(--gold);
      text-shadow: 2px 2px 8px rgba(255, 211, 110, 0.5);
      margin-bottom: 10px;
    }

    .subtitle {
      color: var(--text);
      font-size: 1.2em;
      opacity: 0.8;
    }

    .demo-section {
      background: var(--panel);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    h2 {
      color: var(--gold);
      margin-bottom: 20px;
      font-size: 1.8em;
    }

    .button-group {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    button {
      background: linear-gradient(135deg, var(--blue) 0%, #3b82f6 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(96, 165, 250, 0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(96, 165, 250, 0.5);
    }

    button:active {
      transform: translateY(0);
    }

    button.primary {
      background: linear-gradient(135deg, var(--gold) 0%, #f59e0b 100%);
      box-shadow: 0 4px 12px rgba(255, 211, 110, 0.3);
    }

    button.primary:hover {
      box-shadow: 0 6px 16px rgba(255, 211, 110, 0.5);
    }

    button.success {
      background: linear-gradient(135deg, var(--green) 0%, #10b981 100%);
      box-shadow: 0 4px 12px rgba(125, 255, 180, 0.3);
    }

    button.success:hover {
      box-shadow: 0 6px 16px rgba(125, 255, 180, 0.5);
    }

    .output {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      padding: 20px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      max-height: 600px;
      overflow-y: auto;
      white-space: pre-wrap;
      line-height: 1.5;
    }

    .output:empty::before {
      content: 'Click a button above to see the demo output...';
      opacity: 0.5;
      font-style: italic;
    }

    .character-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .character-card {
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s;
    }

    .character-card:hover {
      transform: translateY(-4px);
      border-color: var(--gold);
      box-shadow: 0 8px 24px rgba(255, 211, 110, 0.3);
    }

    .character-name {
      font-size: 1.5em;
      color: var(--gold);
      margin-bottom: 5px;
    }

    .character-title {
      font-size: 1.1em;
      color: var(--blue);
      margin-bottom: 15px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .stat-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 8px;
      border-radius: 6px;
      text-align: center;
    }

    .stat-label {
      font-size: 0.8em;
      opacity: 0.7;
    }

    .stat-value {
      font-size: 1.3em;
      font-weight: bold;
      color: var(--gold);
    }

    .tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 15px;
    }

    .tag {
      background: rgba(96, 165, 250, 0.3);
      color: var(--blue);
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
      border: 1px solid var(--blue);
    }

    .info-box {
      background: rgba(125, 255, 180, 0.1);
      border: 1px solid var(--green);
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
    }

    .info-box h3 {
      color: var(--green);
      margin-bottom: 10px;
    }

    .scrollbar-custom {
      scrollbar-width: thin;
      scrollbar-color: var(--gold) rgba(0, 0, 0, 0.3);
    }

    .scrollbar-custom::-webkit-scrollbar {
      width: 8px;
    }

    .scrollbar-custom::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 4px;
    }

    .scrollbar-custom::-webkit-scrollbar-thumb {
      background: var(--gold);
      border-radius: 4px;
    }

    .scrollbar-custom::-webkit-scrollbar-thumb:hover {
      background: #f59e0b;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .demo-section {
      animation: fadeIn 0.5s ease-out;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>‚öîÔ∏è William's World ‚öîÔ∏è</h1>
      <p class="subtitle">Battle System Demo ‚Ä¢ Version 1.0</p>
    </header>

    <div class="demo-section">
      <h2>üéÆ Quick Demos</h2>
      <div class="button-group">
        <button class="primary" onclick="runBattleDemo()">‚öîÔ∏è Run Battle Simulation</button>
        <button onclick="showCharacter('trapper')">üõ°Ô∏è View Trapper</button>
        <button onclick="showCharacter('sparkfin')">‚ö° View Sparkfin</button>
        <button onclick="showCharacter('glowmoss')">üçÑ View Glowmoss</button>
        <button class="success" onclick="showTypeChart()">üìä Type Chart</button>
      </div>
      <div id="output" class="output scrollbar-custom"></div>
    </div>

    <div class="demo-section">
      <h2>üé¥ Character Cards</h2>
      <p style="margin-bottom: 20px; opacity: 0.8;">
        The three example characters from the specification:
      </p>
      <div class="character-grid" id="characterGrid"></div>
    </div>

    <div class="demo-section">
      <h2>üìñ About the Battle System</h2>
      <div class="info-box">
        <h3>Design Principles</h3>
        <ul style="margin-left: 20px; line-height: 1.8;">
          <li><strong>Readable in 2 seconds</strong> - Role, type, and function are immediately obvious</li>
          <li><strong>Kid-friendly</strong> - Big icons, minimal reading, emoji usage</li>
          <li><strong>Consistent</strong> - Same layouts and patterns everywhere</li>
          <li><strong>Battle-first</strong> - Everything on a card maps to combat</li>
          <li><strong>Polished</strong> - Smooth animations and satisfying feedback</li>
        </ul>
      </div>

      <div class="info-box" style="margin-top: 20px;">
        <h3>Key Features</h3>
        <ul style="margin-left: 20px; line-height: 1.8;">
          <li><strong>6 Roles</strong> - Striker, Defender, Support, Controller, Summoner, Scout</li>
          <li><strong>10 Element Types</strong> - Fire, Water, Grass, Electric, Ice, Rock, Shadow, Light, Wind, Metal</li>
          <li><strong>Turn-Based 3v3</strong> - Fast tactical battles with clear feedback</li>
          <li><strong>18+ Keywords</strong> - Standardized effects (Damage, Heal, Shield, Stun, etc.)</li>
          <li><strong>Progression</strong> - 3 ranks (Starter ‚Üí Expert ‚Üí Legendary)</li>
        </ul>
      </div>

      <div class="button-group" style="margin-top: 20px;">
        <button onclick="window.open('/battle-system/SPECIFICATION.md')">üìÑ View Full Specification</button>
        <button onclick="window.open('/battle-system/README.md')">üìö View Documentation</button>
      </div>
    </div>
  </div>

  <script src="/battle-system/logic/battle-engine.js"></script>
  <script src="/battle-system/logic/battle-simulator.js"></script>
  <script>
    let simulator = null;
    let gameData = null;

    // Initialize on page load
    async function init() {
      try {
        simulator = new BattleSimulator();
        await simulator.loadGameData();
        gameData = {
          constants: simulator.gameConstants,
          characters: simulator.characters
        };
        
        displayCharacterCards();
        log('Battle system loaded successfully! ‚úì', 'success');
      } catch (error) {
        log('Error loading battle system: ' + error.message, 'error');
        console.error(error);
      }
    }

    function log(message, type = 'info') {
      const output = document.getElementById('output');
      output.textContent = message;
    }

    async function runBattleDemo() {
      if (!simulator) {
        log('Loading battle system...');
        await init();
      }
      
      log('Starting battle simulation...\n\n');
      
      try {
        const result = simulator.runFullBattle();
        
        // Format battle log for display
        let battleText = '='.repeat(60) + '\n';
        battleText += 'BATTLE SIMULATION\n';
        battleText += '='.repeat(60) + '\n\n';
        
        battleText += result.battleLog.map(log => log.message).join('\n');
        battleText += '\n\n' + '='.repeat(60);
        battleText += '\nFinal Result: ' + result.winner.toUpperCase() + ' WINS!';
        battleText += '\n' + '='.repeat(60);
        
        log(battleText);
      } catch (error) {
        log('Error running battle: ' + error.message, 'error');
        console.error(error);
      }
    }

    async function showCharacter(id) {
      if (!simulator) {
        await init();
      }
      
      const char = simulator.characters[id];
      if (!char) {
        log('Character not found: ' + id);
        return;
      }
      
      let text = '‚ïê'.repeat(60) + '\n';
      text += `${char.name} ‚Äî ${char.title}\n`;
      text += '‚ïê'.repeat(60) + '\n\n';
      text += `Role: ${char.role_primary}${char.role_secondary ? ' / ' + char.role_secondary : ''}\n`;
      text += `Types: ${char.types.join(', ')}\n`;
      text += `Rarity: ${char.rarity} | Rank: ${char.rank}\n\n`;
      
      text += 'STATS:\n';
      text += `  HP: ${char.stats.hp}\n`;
      text += `  Power: ${char.stats.power}\n`;
      text += `  Defense: ${char.stats.defense}\n`;
      text += `  Magic Resist: ${char.stats.magicResist}\n`;
      text += `  Speed: ${char.stats.speed}\n\n`;
      
      text += `PASSIVE: ${char.passive.name}\n`;
      text += `  ${char.passive.description}\n\n`;
      
      text += 'MOVES:\n';
      char.moves.forEach((move, i) => {
        text += `  ${i + 1}. ${move.name} (${move.type}) [Cooldown: ${move.cooldown}]\n`;
        text += `     Target: ${move.target}\n`;
        text += `     Keywords: ${move.keywords.join(', ')}\n`;
        text += `     ${move.description}\n\n`;
      });
      
      text += `SYNERGIES: ${char.synergy_tags.join(', ')}\n\n`;
      text += `EXPLORATION PERK: ${char.exploration_perk.name}\n`;
      text += `  ${char.exploration_perk.description}\n`;
      
      log(text);
    }

    async function showTypeChart() {
      if (!simulator) {
        await init();
      }
      
      simulator.displayTypeChart();
      
      const chart = simulator.gameConstants.type_chart;
      const types = Object.keys(chart);
      
      let text = '‚ïê'.repeat(80) + '\n';
      text += 'TYPE EFFECTIVENESS CHART\n';
      text += '‚ïê'.repeat(80) + '\n\n';
      text += 'Legend: 2.0 = Super Effective | 1.0 = Neutral | 0.5 = Not Very Effective\n\n';
      
      // Create header row
      text += 'Attacker ‚Üì vs Defender ‚Üí'.padEnd(20);
      types.forEach(t => {
        text += t.substring(0, 4).padEnd(6);
      });
      text += '\n' + '‚îÄ'.repeat(80) + '\n';
      
      // Create data rows
      types.forEach(attackType => {
        text += attackType.padEnd(20);
        types.forEach(defType => {
          const eff = chart[attackType][defType];
          let display = eff.toFixed(1);
          text += display.padEnd(6);
        });
        text += '\n';
      });
      
      text += '\n' + '‚ïê'.repeat(80);
      
      log(text);
    }

    function displayCharacterCards() {
      if (!gameData) return;
      
      const grid = document.getElementById('characterGrid');
      const charIds = ['trapper', 'sparkfin', 'glowmoss'];
      
      charIds.forEach(id => {
        const char = gameData.characters[id];
        const card = document.createElement('div');
        card.className = 'character-card';
        
        card.innerHTML = `
          <div class="character-name">${char.name}</div>
          <div class="character-title">${char.title}</div>
          <div style="opacity: 0.8; margin-bottom: 10px;">
            <strong>Role:</strong> ${char.role_primary}<br>
            <strong>Types:</strong> ${char.types.join(', ')}
          </div>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-label">HP</div>
              <div class="stat-value">${char.stats.hp}</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Power</div>
              <div class="stat-value">${char.stats.power}</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Defense</div>
              <div class="stat-value">${char.stats.defense}</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Speed</div>
              <div class="stat-value">${char.stats.speed}</div>
            </div>
          </div>
          <div class="tags">
            ${char.synergy_tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
        `;
        
        grid.appendChild(card);
      });
    }

    // Initialize on load
    init();
  </script>
</body>
</html>
